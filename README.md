# Kapten

Kapten is a meta orchestration framework for building R and Python data pipelines with Prefect. It was built after experience with Prefect, tuning it from a general-purpose workflow tool to a data pipeline solution. It right-sizes tasks, tests changes, and streamlines development and operation.

Define your tasks and their dependencies in YAML and Kapten will render a pipeline runnable locally or on AWS with one click.

## Features

  - **Testable tasks** : Built-in change detection
  - **Right-sizing**: CPU and memory requirements per task
  - **Branch-based development**: Clone pipeline state across branches
  - **Update in-place**: Tweak and run a subset of the pipeline
  - **Less boilerplate code**: R tasks don't require writing any wrapper code
  - **Less vendor lock-in**: Any orchestration framework could be rendered, not just Prefect

## Basic Example

Here's a toy example of a pipeline called `example` with 3 tasks: `A`, `B`, `C`. We first define the graph of tasks, where `A` has no dependencies, `B` depends on `A`, and `C` depends on `A` and `B`.

```yaml
graphs:
  example:
    tasks:
      A:
      B: A
      C: [A, B]
```

In the same YAML file, we can define the tasks (2 R tasks, 1 Python task):

```yaml
tasks:
  A:
    r_script: "A/run.R"
    outputs: ["A.csv"]
  B:
    py_script: "B/run.R"
    outputs: ["B.csv"]
  C:
    py_script: true
    outputs: ["C.csv"]
```

The `r_script` and `py_script` fields define the location of the script to run. In the Python case, there must exist a script `tasks/C.py` with a function `C()`. The `outputs` field are the files generated by the script.
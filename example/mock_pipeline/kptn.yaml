settings:
  flows_dir: "flows" # Workflows (.py) generated by codegen
  py_tasks_dir: "py_tasks" # Task code (.py)
  r_tasks_dir: "r_tasks"
  flow_type: vanilla # Workflow type is vanilla python (no framework)

graphs:

  sample:
    tasks:
      A:
      B: A
      C:
      D: C
      E: [B, D]

  output_hashing:
    tasks:
      subtask_list:
      write_param: [subtask_list]
      static_params: []

  subtasktest:
    tasks:
      subtask_list:
      subtask_process: [subtask_list]
  
  combotest:
    tasks:
      combo_list:
      combo_process: [combo_list]

  bundling:
    tasks:
      combo50_list:
      combo_process_bundle: [combo50_list]

  grouping:
    tasks:
      combo50_list:
      combo_process_group: [combo50_list]

  bundlegroup:
    tasks:
      combo50_list:
      combo_process_bundle_group: [combo50_list]

  bundlegroup_R:
    tasks:
      combo50_list:
      combo_process_bundle_group_R: [combo50_list]

  subset:
    tasks:
      subtask_list:
      do_nothing: [subtask_list]

  subset_bundlegroup_R:
    tasks:
      combo50_list:
      do_nothing_bundle_group_R: [combo50_list]

tasks:
  A:
    file: "r_tasks/A/run.R"
    outputs: ["A_${year}"]
    compute:
      cpu: 256
      memory: 512
  B:
    file: py_tasks/B.py
    outputs: ["B_${year}"]
    compute:
      cpu: 256
      memory: 512
  C:
    file: py_tasks/C.py
    cache_result: true
    iterable_item: C_VAL
    compute:
      cpu: 256
      memory: 512
  D:
    file: "r_tasks/D/run.R"
    outputs: ["D_${year}"]
    map_over: C_VAL
    compute:
      cpu: 256
      memory: 512
  E:
    file: py_tasks/E.py
    outputs: ["E_${year}"]
    compute:
      cpu: 256
      memory: 512

  subtask_list:
    file: py_tasks/subtask_list.py
    cache_result: true
    iterable_item: item
    compute:
      cpu: 256
      memory: 512

  subtask_process:
    file: py_tasks/subtask_process.py
    map_over: item
    compute:
      cpu: 256
      memory: 512

  combo_list:
    file: py_tasks/combo_list.py
    cache_result: true
    iterable_item: item1,item2

  combo_process:
    file: py_tasks/combo_process.py
    map_over: item1,item2

  combo50_list:
    file: py_tasks/combo50_list.py
    cache_result: true
    iterable_item: item1,item2

  combo_process_bundle:
    file: py_tasks/combo_process.py:combo_process
    map_over: item1,item2
    bundle_size: 10

  combo_process_group:
    file: py_tasks/combo_process.py:combo_process
    map_over: item1,item2
    group_size: 25

  combo_process_bundle_group:
    file: py_tasks/combo_process.py:combo_process
    map_over: item1,item2
    bundle_size: 3
    group_size: 10

  combo_process_bundle_group_R:
    file: "r_tasks/combo_process_bundle_group/run.R"
    logs: "${item1}_${item2}.log"
    map_over: item1,item2
    bundle_size: 3
    group_size: 10

  do_nothing:
    file: py_tasks/do_nothing.py
    map_over: item

  do_nothing_bundle_group_R:
    file: "r_tasks/do_nothing/run.R"
    map_over: item1,item2
    bundle_size: 3
    group_size: 10
  
  write_param:
    file: r_tasks/write_param.R
    map_over: item
    outputs:
    - my_output/${item}-${some.var}.txt

  static_params:
    file: r_tasks/static_params.R
    outputs:
    - my_output/dummy1-${some.var}.txt
    - my_output/dummy2-${some.var}.txt

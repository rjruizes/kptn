settings:
  flows-dir: "flows" # Workflows (.py) generated by codegen
  py-tasks-dir: "py_tasks" # Task code (.py)
  r-tasks-dir: "r_tasks"
  flow-type: python # Workflow type is vanilla python (no framework)

graphs:

  sample:
    tasks:
      A:
      B: A
      C:
      D: C
      E: [B, D]

  output_hashing:
    tasks:
      subtask_list:
      write_param: [subtask_list]
      static_params: []

  subtasktest:
    tasks:
      subtask_list:
      subtask_process: [subtask_list]
  
  combotest:
    tasks:
      combo_list:
      combo_process: [combo_list]

  bundling:
    tasks:
      combo50_list:
      combo_process_bundle: [combo50_list]

  grouping:
    tasks:
      combo50_list:
      combo_process_group: [combo50_list]

  bundlegroup:
    tasks:
      combo50_list:
      combo_process_bundle_group: [combo50_list]

  bundlegroup_R:
    tasks:
      combo50_list:
      combo_process_bundle_group_R: [combo50_list]

  subset:
    tasks:
      subtask_list:
      do_nothing: [subtask_list]

  subset_bundlegroup_R:
    tasks:
      combo50_list:
      do_nothing_bundle_group_R: [combo50_list]

tasks:
  A:
    r_script: "A/run.R"
    outputs: ["A_${year}"]
    aws_vars:
      cpu: 256
      memory: 512
  B:
    py_script: true
    outputs: ["B_${year}"]
    aws_vars:
      cpu: 256
      memory: 512
  C:
    py_script: true
    cache_result: true
    iterable_item: C_VAL
    aws_vars:
      cpu: 256
      memory: 512
  D:
    r_script: "D/run.R"
    outputs: ["D_${year}"]
    map_over: C_VAL
    aws_vars:
      cpu: 256
      memory: 512
  E:
    py_script: true
    outputs: ["E_${year}"]
    aws_vars:
      cpu: 256
      memory: 512

  subtask_list:
    py_script: true
    cache_result: true
    iterable_item: item
    aws_vars:
      cpu: 256
      memory: 512

  subtask_process:
    py_script: true
    map_over: item
    aws_vars:
      cpu: 256
      memory: 512

  combo_list:
    py_script: true
    cache_result: true
    iterable_item: item1,item2

  combo_process:
    py_script: true
    map_over: item1,item2

  combo50_list:
    py_script: true
    cache_result: true
    iterable_item: item1,item2

  combo_process_bundle:
    py_script: combo_process.py
    map_over: item1,item2
    bundle_size: 10

  combo_process_group:
    py_script: combo_process.py
    map_over: item1,item2
    group_size: 25

  combo_process_bundle_group:
    py_script: combo_process.py
    map_over: item1,item2
    bundle_size: 3
    group_size: 10

  combo_process_bundle_group_R:
    r_script: "combo_process_bundle_group/run.R"
    logs: "${item1}_${item2}.log"
    map_over: item1,item2
    bundle_size: 3
    group_size: 10

  do_nothing:
    py_script: true
    map_over: item

  do_nothing_bundle_group_R:
    r_script: "do_nothing/run.R"
    map_over: item1,item2
    bundle_size: 3
    group_size: 10
  
  write_param:
    r_script: write_param.R
    map_over: item
    outputs:
    - my_output/${item}-${some.var}.txt

  static_params:
    r_script: static_params.R
    outputs:
    - my_output/dummy1-${some.var}.txt
    - my_output/dummy2-${some.var}.txt
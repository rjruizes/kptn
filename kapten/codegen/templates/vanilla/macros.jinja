
{% macro deps_to_str(deps) %}
{%- for dep in deps -%}
{%- set _dep = "_" + dep %}
            {{ _dep }}{% if not loop.last %},{% endif %}
{%- endfor %}
{%- endmacro %}

{% macro submit(name, deps, python_task_names, tasks_dict, rel_py_tasks_dir) -%}
{%- set task_config = tasks_dict.get(name, {}) -%}
{%- set file_value = task_config.get('file', '') -%}
{%- if file_value -%}
{%- set file_path = file_value.split(':')[0] -%}
    submit("{{name}}", opts)  # file://./{{ rel_py_tasks_dir }}/{{ file_path }}
{%- else -%}
    submit("{{name}}", opts)
{%- endif %}
{%- endmacro %}
